{% extends "base.html" %}

{% block title %}Services{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <img src="{{ url_for('static', filename='dogcare.png') }}" class="card-img-top" alt="Dog Care">
      <div class="card-body">
        <h5 class="card-title">Dog Care</h5>
        <p class="card-text">We can walk your dog outside if you do not have enough time for this</p>
        {% if current_user.is_authenticated %}
          <button class="btn btn-primary" onclick="showOrderDialog('Dog Care')">Order Now</button>
        {% else %}
          <button class="btn btn-primary" disabled data-toggle="modal" data-target="#loginModal">Order Now</button>
          <p class="text-muted">You must be logged in to place an order. <a href="{{ url_for('login') }}">Log in</a> or <a href="{{ url_for('register') }}">create an account</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <img src="{{ url_for('static', filename='carwash.png') }}" class="card-img-top" alt="Car Wash">
      <div class="card-body">
        <h5 class="card-title">Car Wash</h5>
        <p class="card-text">We will take care of your car, both externally and internally</p>
        {% if current_user.is_authenticated %}
          <button class="btn btn-primary" onclick="showOrderDialog('Car Wash')">Order Now</button>
        {% else %}
          <button class="btn btn-primary" disabled data-toggle="modal" data-target="#loginModal">Order Now</button>
          <p class="text-muted">You must be logged in to place an order. <a href="{{ url_for('login') }}">Log in</a> or <a href="{{ url_for('register') }}">create an account</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <img src="{{ url_for('static', filename='housecleaning.png') }}" class="card-img-top" alt="House Cleaning">
      <div class="card-body">
        <h5 class="card-title">House Cleaning</h5>
        <p class="card-text">We will clean your house perfectly (also includes the yard)</p>
        {% if current_user.is_authenticated %}
          <button class="btn btn-primary" onclick="showOrderDialog('House Cleaning')">Order Now</button>
        {% else %}
          <button class="btn btn-primary" disabled data-toggle="modal" data-target="#loginModal">Order Now</button>
          <p class="text-muted">You must be logged in to place an order. <a href="{{ url_for('login') }}">Log in</a> or <a href="{{ url_for('register') }}">create an account</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <img src="{{ url_for('static', filename='taketrash.png') }}" class="card-img-top" alt="Take Trash">
      <div class="card-body">
        <h5 class="card-title">Take Trash</h5>
        <p class="card-text">We can take out your trash if you do not have time for it</p>
        {% if current_user.is_authenticated %}
          <button class="btn btn-primary" onclick="showOrderDialog('Take Trash')">Order Now</button>
        {% else %}
          <button class="btn btn-primary" disabled data-toggle="modal" data-target="#loginModal">Order Now</button>
          <p class="text-muted">You must be logged in to place an order. <a href="{{ url_for('login') }}">Log in</a> or <a href="{{ url_for('register') }}">create an account</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <img src="{{ url_for('static', filename='shipping.png') }}" class="card-img-top" alt="Shipping">
      <div class="card-body">
        <h5 class="card-title">Shipping</h5>
        <p class="card-text">Deliver anything from one point to another in Georgia</p>
        {% if current_user.is_authenticated %}
          <button class="btn btn-primary" onclick="showOrderDialog('Shipping')">Order Now</button>
        {% else %}
          <button class="btn btn-primary" disabled data-toggle="modal" data-target="#loginModal">Order Now</button>
          <p class="text-muted">You must be logged in to place an order. <a href="{{ url_for('login') }}">Log in</a> or <a href="{{ url_for('register') }}">create an account</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <img src="{{ url_for('static', filename='babysitter.png') }}" class="card-img-top" alt="Babysitter">
      <div class="card-body">
        <h5 class="card-title">Babysitter</h5>
        <p class="card-text">Highly qualified and reliable persons will take care of your child</p>
        {% if current_user.is_authenticated %}
          <button class="btn btn-primary" onclick="showOrderDialog('Babysitter')">Order Now</button>
        {% else %}
          <button class="btn btn-primary" disabled data-toggle="modal" data-target="#loginModal">Order Now</button>
          <p class="text-muted">You must be logged in to place an order. <a href="{{ url_for('login') }}">Log in</a> or <a href="{{ url_for('register') }}">create an account</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <img src="{{ url_for('static', filename='shopping.png') }}" class="card-img-top" alt="Shopping">
      <div class="card-body">
        <h5 class="card-title">Shopping</h5>
        <p class="card-text">We will buy products or clothes in any store for you</p>
        {% if current_user.is_authenticated %}
          <button class="btn btn-primary" onclick="showOrderDialog('Shopping')">Order Now</button>
        {% else %}
          <button class="btn btn-primary" disabled data-toggle="modal" data-target="#loginModal">Order Now</button>
          <p class="text-muted">You must be logged in to place an order. <a href="{{ url_for('login') }}">Log in</a> or <a href="{{ url_for('register') }}">create an account</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <img src="{{ url_for('static', filename='fakepartner.png') }}" class="card-img-top" alt="Fake Partner">
      <div class="card-body">
        <h5 class="card-title">Fake Partner</h5>
        <p class="card-text">You will have a guy or girl next to you in a business meeting or pretending to be in a fake relationship</p>
        {% if current_user.is_authenticated %}
          <button class="btn btn-primary" onclick="showOrderDialog('Fake Partner')">Order Now</button>
        {% else %}
          <button class="btn btn-primary" disabled data-toggle="modal" data-target="#loginModal">Order Now</button>
          <p class="text-muted">You must be logged in to place an order. <a href="{{ url_for('login') }}">Log in</a> or <a href="{{ url_for('register') }}">create an account</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  
</div>

<!-- Modal -->
<div class="modal fade" id="orderModal" tabindex="-1" role="dialog" aria-labelledby="orderModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="orderModalLabel">Order Service</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="inputName">Name</label>
            <input type="text" class="form-control" id="inputName" placeholder="Enter your name">
          </div>
          <div class="form-group">
            <label for="inputSurname">Surname</label>
            <input type="text" class="form-control" id="inputSurname" placeholder="Enter your surname">
          </div>
          <div class="form-group">
            <label for="inputPhone">Phone Number</label>
            <input type="text" class="form-control" id="inputPhone" placeholder="Enter your phone number">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="submitOrder()">Submit Order</button>
      </div>
    </div>
  </div>
</div>

<script>
  function showOrderDialog(serviceName) {
    $('#orderModalLabel').text('Order ' + serviceName);
    $('#inputName').val('');
    $('#inputSurname').val('');
    $('#inputPhone').val('');
    $('#orderModal').modal('show');
    $('#orderModal').data('service', serviceName);
  }

  function submitOrder() {
    var name = $('#inputName').val();
    var surname = $('#inputSurname').val();
    var phone = $('#inputPhone').val();
    var serviceName = $('#orderModal').data('service');

    
    console.log('Name:', name);
    console.log('Surname:', surname);
    console.log('Phone:', phone);
    console.log('Service:', serviceName);

    // Make an AJAX request to submit the order
    $.ajax({
      url: '/submit_order',
      type: 'POST',
      data: {
        name: name,
        surname: surname,
        phone: phone,
        service: serviceName
      },
      success: function(response) {
        // Handle the success response
        console.log('Order submitted successfully');
        // Redirect to the order confirmation page using Flask route
        window.location.href = '/order/' + encodeURIComponent(response.service);
      },
      error: function(error) {
        // Handle the error response
        console.error('Error submitting order:', error);
      }
    });

    // Hide the modal
    $('#orderModal').modal('hide');
  }
</script>
{% endblock %}
